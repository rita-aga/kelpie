============================= test session starts ==============================
platform darwin -- Python 3.12.11, pytest-9.0.2, pluggy-1.6.0 -- /Users/seshendranalla/Development/kelpie/tests/letta_compatibility/.venv/bin/python3.12
cachedir: .pytest_cache
metadata: {'Python': '3.12.11', 'Platform': 'macOS-15.3-arm64-arm-64bit', 'Packages': {'pytest': '9.0.2', 'pluggy': '1.6.0'}, 'Plugins': {'anyio': '4.12.1', 'ddtrace': '4.2.1', 'mock': '3.15.1', 'json-report': '1.5.0', 'metadata': '3.1.1', 'order': '1.3.0', 'asyncio': '1.3.0', 'Faker': '40.1.2', 'typeguard': '4.4.4'}, 'JAVA_HOME': '/Library/Java/JavaVirtualMachines/jdk-21.jdk/Contents/Home'}
rootdir: /Users/seshendranalla/Development/letta/tests
configfile: pytest.ini
plugins: anyio-4.12.1, ddtrace-4.2.1, mock-3.15.1, json-report-1.5.0, metadata-3.1.1, order-1.3.0, asyncio-1.3.0, Faker-40.1.2, typeguard-4.4.4
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=function, asyncio_default_test_loop_scope=function
collecting ... collected 1 item

tests/sdk/mcp_servers_test.py::test_mcp_echo_tool_with_agent FAILED      [100%]

=================================== FAILURES ===================================
________________________ test_mcp_echo_tool_with_agent _________________________
tests/sdk/mcp_servers_test.py:779: in test_mcp_echo_tool_with_agent
    response = client.agents.messages.create(
../kelpie/tests/letta_compatibility/.venv/lib/python3.12/site-packages/letta_client/resources/agents/messages.py:389: in create
    return self._post(
../kelpie/tests/letta_compatibility/.venv/lib/python3.12/site-packages/letta_client/_base_client.py:1277: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../kelpie/tests/letta_compatibility/.venv/lib/python3.12/site-packages/letta_client/_base_client.py:1064: in request
    raise self._make_status_error_from_response(err.response) from None
E   letta_client.InternalServerError: Error code: 500 - {'code': 'internal_error', 'message': 'LLM not configured. Set ANTHROPIC_API_KEY or OPENAI_API_KEY environment variable.', 'details': None}
---------------------------- Captured stdout setup -----------------------------
httpx - INFO - HTTP Request: POST http://localhost:8283/v1/mcp-servers/ "HTTP/1.1 200 OK"
httpx - INFO - HTTP Request: GET http://localhost:8283/v1/mcp-servers/mcp_server-c956ecdf-651a-4d3a-b943-692441a5b873/tools "HTTP/1.1 200 OK"
httpx - INFO - HTTP Request: POST http://localhost:8283/v1/agents/ "HTTP/1.1 200 OK"
------------------------------ Captured log setup ------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://localhost:8283/v1/mcp-servers/ "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1025 HTTP Request: GET http://localhost:8283/v1/mcp-servers/mcp_server-c956ecdf-651a-4d3a-b943-692441a5b873/tools "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1025 HTTP Request: POST http://localhost:8283/v1/agents/ "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
httpx - INFO - HTTP Request: POST http://localhost:8283/v1/agents/10ed921a-7358-41db-ab43-7d41b1f53712/messages "HTTP/1.1 500 Internal Server Error"
letta_client._base_client - INFO - Retrying request to /v1/agents/10ed921a-7358-41db-ab43-7d41b1f53712/messages in 0.398481 seconds
httpx - INFO - HTTP Request: POST http://localhost:8283/v1/agents/10ed921a-7358-41db-ab43-7d41b1f53712/messages "HTTP/1.1 500 Internal Server Error"
letta_client._base_client - INFO - Retrying request to /v1/agents/10ed921a-7358-41db-ab43-7d41b1f53712/messages in 0.787767 seconds
httpx - INFO - HTTP Request: POST http://localhost:8283/v1/agents/10ed921a-7358-41db-ab43-7d41b1f53712/messages "HTTP/1.1 500 Internal Server Error"
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://localhost:8283/v1/agents/10ed921a-7358-41db-ab43-7d41b1f53712/messages "HTTP/1.1 500 Internal Server Error"
INFO     letta_client._base_client:_base_client.py:1088 Retrying request to /v1/agents/10ed921a-7358-41db-ab43-7d41b1f53712/messages in 0.398481 seconds
INFO     httpx:_client.py:1025 HTTP Request: POST http://localhost:8283/v1/agents/10ed921a-7358-41db-ab43-7d41b1f53712/messages "HTTP/1.1 500 Internal Server Error"
INFO     letta_client._base_client:_base_client.py:1088 Retrying request to /v1/agents/10ed921a-7358-41db-ab43-7d41b1f53712/messages in 0.787767 seconds
INFO     httpx:_client.py:1025 HTTP Request: POST http://localhost:8283/v1/agents/10ed921a-7358-41db-ab43-7d41b1f53712/messages "HTTP/1.1 500 Internal Server Error"
--------------------------- Captured stdout teardown ---------------------------
httpx - INFO - HTTP Request: DELETE http://localhost:8283/v1/agents/10ed921a-7358-41db-ab43-7d41b1f53712 "HTTP/1.1 200 OK"
httpx - INFO - HTTP Request: DELETE http://localhost:8283/v1/mcp-servers/mcp_server-c956ecdf-651a-4d3a-b943-692441a5b873 "HTTP/1.1 200 OK"
---------------------------- Captured log teardown -----------------------------
INFO     httpx:_client.py:1025 HTTP Request: DELETE http://localhost:8283/v1/agents/10ed921a-7358-41db-ab43-7d41b1f53712 "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1025 HTTP Request: DELETE http://localhost:8283/v1/mcp-servers/mcp_server-c956ecdf-651a-4d3a-b943-692441a5b873 "HTTP/1.1 200 OK"
=============================== warnings summary ===============================
letta/schemas/letta_message.py:207
  /Users/seshendranalla/Development/letta/letta/schemas/letta_message.py:207: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ToolCallMessage(LettaMessage):

../kelpie/tests/letta_compatibility/.venv/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:319
../kelpie/tests/letta_compatibility/.venv/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:319
../kelpie/tests/letta_compatibility/.venv/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:319
../kelpie/tests/letta_compatibility/.venv/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:319
  /Users/seshendranalla/Development/kelpie/tests/letta_compatibility/.venv/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:319: PydanticDeprecatedSince20: `json_encoders` is deprecated. See https://docs.pydantic.dev/2.12/concepts/serialization/#custom-serializers for alternatives. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    warnings.warn(

letta/schemas/response_format.py:18
  /Users/seshendranalla/Development/letta/letta/schemas/response_format.py:18: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'example'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    type: ResponseFormatType = Field(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/sdk/mcp_servers_test.py::test_mcp_echo_tool_with_agent - letta_c...
======================== 1 failed, 6 warnings in 1.85s =========================

OpenTelemetry configuration OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE is not supported by Datadog.
