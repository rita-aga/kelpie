\* KelpieWAL_Buggy.cfg - TLC configuration for BUGGY version
\*
\* This configuration tests a buggy implementation that skips idempotency
\* checking, allowing duplicate WAL entries for the same client+key.
\*
\* Expected result: TLC should find a counterexample where Idempotency
\* is violated (two WAL entries have the same client and idempotencyKey).
\*
\* Bug scenario (without idempotency check):
\* 1. Client c1 appends entry with key=1
\* 2. Client c1 appends another entry with key=1 (BUGGY: not rejected)
\* 3. VIOLATION: Two entries exist with same client+idempotencyKey
\*
\* NOTE: Requires BUGGY constant added to KelpieWAL.tla with conditional
\* logic in AppendToWal to skip IdempotencyKeyExists check when BUGGY=TRUE.
\*
\* Run with:
\*   java -XX:+UseParallelGC -jar ~/tla2tools.jar -deadlock -config KelpieWAL_Buggy.cfg KelpieWAL.tla

\* Model constants - single client sufficient to expose idempotency bug
CONSTANTS
    Clients = {c1}
    MaxEntries = 3          \* Small for fast counterexample
    MaxOperations = 3
    BUGGY = TRUE            \* Skip idempotency check

\* Specification to check (safety only, no fairness)
SPECIFICATION SafetySpec

\* Safety invariants (expect Idempotency to FAIL)
INVARIANT TypeOK
INVARIANT Durability
INVARIANT Idempotency
INVARIANT AtomicVisibility

\* State constraint for bounded model checking
CONSTRAINT StateConstraint

\* Note: Symmetry disabled for buggy config (faster counterexample search)
