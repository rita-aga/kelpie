\* KelpieSingleActivation_Buggy.cfg - TLC configuration for BUGGY version
\*
\* This configuration tests a buggy implementation that skips version checking
\* during commit, allowing concurrent activations (split-brain).
\*
\* Expected result: TLC should find a counterexample where SingleActivation
\* is violated (two nodes are both in "Active" state simultaneously).
\*
\* Bug scenario (without version check):
\* 1. Node n1 reads holder=NONE, version=0
\* 2. Node n2 reads holder=NONE, version=0
\* 3. Node n1 commits successfully (no conflict, becomes holder)
\* 4. Node n2 commits successfully (BUGGY: ignores version mismatch)
\* 5. VIOLATION: Both n1 and n2 believe they are active
\*
\* NOTE: Requires BUGGY constant added to KelpieSingleActivation.tla with
\* conditional logic in CommitClaim to skip version check when BUGGY=TRUE.
\*
\* Run with:
\*   java -XX:+UseParallelGC -jar ~/tla2tools.jar -deadlock -config KelpieSingleActivation_Buggy.cfg KelpieSingleActivation.tla

\* =========================================================================
\* SPECIFICATION
\* =========================================================================

SPECIFICATION SafetySpec  \* No fairness needed for safety violation

\* =========================================================================
\* CONSTANTS
\* =========================================================================

\* Minimal model: 2 nodes is sufficient to expose split-brain
CONSTANT
    Nodes = {n1, n2}
    NONE = NONE
    BUGGY = TRUE

\* =========================================================================
\* STATE CONSTRAINT
\* =========================================================================

CONSTRAINT StateConstraint

\* =========================================================================
\* INVARIANTS (expect SingleActivation to FAIL)
\* =========================================================================

\* TypeOK should still hold (bug doesn't break types)
INVARIANT TypeOK

\* This is the key invariant that should FAIL in buggy mode
INVARIANT SingleActivation

\* ConsistentHolder may also fail as a consequence
INVARIANT ConsistentHolder
